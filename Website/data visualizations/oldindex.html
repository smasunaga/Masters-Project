<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>Federal Disease Funding</title>
	<style type="text/css">
		.chart{
			stroke: black;
		}

		.dot{
			fill: 2;
			stroke: #ffccff;
		}

		.line{
			fill: none;
			stroke: black;
		}

		.domain{
			fill: none;
			stroke: red;
		}

		.tick{
			font-size: 14px;
		}

		.axis path, .axis line{
			fill: none;
			stroke: #000000;
			shape-rendering: crispEdges;
		}

		.x.axis path{
			display: none;
		}

	</style>
</head>
<body>
	<script src="d3.min.js"></script>
	<div class="chart"></div>
	<script type="text/javascript">
		
		var margin = {top: 20, right: 20, bottom: 20, left: 20};
    		width = 600 - margin.left - margin.right,
    		height = 300 - margin.top - margin.bottom;

		var svg = d3.select(".chart").append("svg")
    		.attr("width", width + margin.left + margin.right)
    		.attr("height", height + margin.top + margin.bottom)
  			.append("g")
  			.attr("transform", "translate(" + margin.left + "," + margin.top + ")");

    // creates a different color per line
    var color = d3.scale.category10();
  			
  		d3.csv("fedfundingtotals.csv", function(error, data){
        color.domain(d3.keys(data[0]).filter(function(key) { return key !== "funding" && key !=="date"}));

  			data.forEach(function(d) {
  				d.funding = +d.funding;
          d.year = +d.year;
  			});
  			console.log(data);

    var diseases = color.domain().map(function(name) {
      return { 
               name   : Diseases,
               values : date: d.year, funding: +d[funding]};
    })

      //creates data nests based on year 
      var nested = d3.nest()
        .key(function(d) { return d.Diseases;})
        .sortValues(function(a, b) { return b.funding - a.funding; })
        .entries(data)
        console.log(nested);

  		var xScale = d3.time.scale()
  			.domain([2010, 2014])
  			.range([0, width]);

  		var xAxis = d3.svg.axis()
  			.tickFormat(function(d) { return d; })
  			.tickValues([2010, 2011, 2012, 2013, 2014])
  			.scale(xScale);

  		var formatxAxis = d3.format('.0f');

  		var yScale = d3.scale.linear()
  			.domain([0, 6700])
  			.range([height, 0]);

  		var yAxis = d3.svg.axis()
  			.orient("left")
  			.tickFormat(function(d) { return d; })
  			.scale(yScale);

      var line = d3.svg.line()
        .interpolate('basis')
        .x(function (d) { return x(d.year); })
        .y(function (d) { return y(d.funding); });

  		svg.selectAll(".dot")
  			.data(data)
  			.enter()
  			.append("circle")
  			.attr("class", "dot")
  			.attr("r", 2)
  			.attr("cx", function(d, i) { return xScale(d.year); })
  			.attr("cy", function(d) { return yScale(d.funding); });

  		// svg.append("path")
  		// 	.attr("class", "line")
  		// 	.attr("d", line(data) );

  		svg.append("g")
  			.attr("class", "axis")
  			.attr("transform", "translate(0, " + height + ")")
  			.call(xAxis)

  		svg.append("g")
  			.attr("class", "y axis")
  			.call(yAxis);
  	});

	</script>


</body>
</html>